# klassische Policy (Device / Machine)
Get-ChildItem "HKLM:\SOFTWARE\Policies\Microsoft\OneDrive" -ErrorAction SilentlyContinue
Get-ChildItem "HKLM:\SOFTWARE\Policies\Microsoft\OneDrive\TenantAutoMount" -ErrorAction SilentlyContinue

# MDM PolicyManager (Intune/ADMX ingestion)
Get-ChildItem "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\device\OneDrive" -ErrorAction SilentlyContinue
Get-ChildItem "HKLM:\SOFTWARE\Microsoft\PolicyManager\current\user\OneDrive" -ErrorAction SilentlyContinue


Stop-Process -Name OneDrive -Force -ErrorAction SilentlyContinue
Start-Process "$env:LOCALAPPDATA\Microsoft\OneDrive\OneDrive.exe" -ArgumentList "/reset"

$exe = @(
  "$env:LOCALAPPDATA\Microsoft\OneDrive\OneDrive.exe",
  "$env:ProgramFiles\Microsoft OneDrive\OneDrive.exe",
  "${env:ProgramFiles(x86)}\Microsoft OneDrive\OneDrive.exe"
) | Where-Object { Test-Path $_ } | Select-Object -First 1

$exe



Stop-Process -Name OneDrive -Force -ErrorAction SilentlyContinue
Start-Process $exe -ArgumentList "/reset"
Start-Sleep 3
Start-Process $exe

